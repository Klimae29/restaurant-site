---
// src/components/Header.astro - Version am√©lior√©e
---

<header class="fixed top-0 w-full z-50 bg-red-700/95 backdrop-blur-md shadow-xl transition-all duration-300" id="header">
    <div class="w-full px-6">
      <nav class="flex items-center justify-between py-4">

      <!-- Logo -->
      <div class="z-20 relative">
        <a href="#" class="block group transform transition-all duration-300">
          <h1 class="font-['Dancing_Script'] text-3xl md:text-4xl font-bold text-yellow-400 group-hover:text-white transition-colors duration-300">
            Coraz√≥n Latino
          </h1>
          <p class="font-sans text-xs text-white/70 tracking-wide mt-1 hidden md:block group-hover:text-yellow-200 transition-colors duration-300">
            Authentic Sud-American
          </p>
        </a>
      </div>

      <!-- Menu Burger -->
      <div class="z-20 relative">
        <button
          id="burger-btn"
          class="burger-menu relative w-10 h-10 focus:outline-none group flex flex-col items-center justify-center"
          aria-label="Menu"
        >
          <!-- Lignes du burger stylis√©es -->
          <span class="burger-line block w-7 h-0.5 bg-yellow-400 transition-all duration-300 ease-in-out mb-1.5 group-hover:bg-white"></span>
          <span class="burger-line block w-7 h-0.5 bg-yellow-400 transition-all duration-300 ease-in-out mb-1.5 group-hover:bg-white"></span>
          <span class="burger-line block w-7 h-0.5 bg-yellow-400 transition-all duration-300 ease-in-out group-hover:bg-white"></span>

          <!-- Texte "MENU" en dessous -->
          <span class="text-xs text-yellow-400 font-medium mt-1 group-hover:text-white transition-colors duration-300 hidden md:block">
            MENU
          </span>
        </button>
      </div>
    </nav>
  </div>

  <!-- Menu Lateral Droit - Sans transparence -->
  <div id="mobile-menu" class="menu-overlay fixed top-0 right-0 h-full w-full md:w-96 bg-red-900 transform translate-x-full transition-all duration-500 ease-out shadow-2xl z-40">
    <!-- Background Pattern d√©coratif -->
    <div class="absolute inset-0 opacity-10">
      <div class="absolute top-20 right-10 w-32 h-32 border border-yellow-400/30 rounded-full animate-pulse"></div>
      <div class="absolute bottom-32 left-8 w-24 h-24 border border-yellow-400/20 rotate-45"></div>
      <div class="absolute top-1/2 right-16 w-16 h-16 bg-yellow-400/10 rounded-full"></div>
    </div>

    <div class="relative h-full flex flex-col">

      <!-- Header du menu avec bouton fermer -->
      <div class="flex justify-between items-center p-6 border-b border-yellow-400/20">
        <div class="font-['Dancing_Script'] text-2xl md:text-3xl text-yellow-400 font-bold">
          Menu
        </div>
        <button
          id="close-menu"
          class="w-10 h-10 flex items-center justify-center rounded-full bg-yellow-400/20 hover:bg-yellow-400/30 transition-all duration-300 group"
        >
          <svg class="w-5 h-5 text-yellow-400 group-hover:rotate-90 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>

      <!-- Navigation principale -->
      <div class="flex-1 flex flex-col justify-center px-6 py-8 bg-red-800">
        <nav class="space-y-6">

          <a href="#hero" class="nav-item block font-['Playfair_Display'] text-2xl md:text-3xl font-bold text-white hover:text-yellow-400 transition-all duration-300 transform hover:translate-x-2 border-b border-transparent hover:border-yellow-400/50 pb-2">
            Inicio
          </a>

          <a href="#platos" class="nav-item block font-['Playfair_Display'] text-2xl md:text-3xl font-bold text-white hover:text-yellow-400 transition-all duration-300 transform hover:translate-x-2 border-b border-transparent hover:border-yellow-400/50 pb-2">
            Platos
          </a>

          <a href="#menu" class="nav-item block font-['Playfair_Display'] text-2xl md:text-3xl font-bold text-white hover:text-yellow-400 transition-all duration-300 transform hover:translate-x-2 border-b border-transparent hover:border-yellow-400/50 pb-2">
            Men√∫
          </a>

          <a href="#restaurant" class="nav-item block font-['Playfair_Display'] text-2xl md:text-3xl font-bold text-white hover:text-yellow-400 transition-all duration-300 transform hover:translate-x-2 border-b border-transparent hover:border-yellow-400/50 pb-2">
            Restaurante
          </a>

          <a href="#contacto" class="nav-item block font-['Playfair_Display'] text-2xl md:text-3xl font-bold text-white hover:text-yellow-400 transition-all duration-300 transform hover:translate-x-2 border-b border-transparent hover:border-yellow-400/50 pb-2">
            Contacto
          </a>

          <!-- Bouton r√©servation -->
          <div class="pt-8">
            <a href="#reservar" class="block bg-yellow-400 hover:bg-white text-gray-800 font-bold text-lg px-6 py-3 rounded-lg transition-all duration-300 transform hover:scale-105 text-center shadow-lg">
              ¬°Reservar Mesa!
            </a>
          </div>
        </nav>
      </div>

      <!-- Footer du menu avec infos contact -->
      <div class="p-6 border-t border-yellow-400/20">
        <div class="space-y-3 text-white/90 text-sm">
          <div class="flex items-center gap-3">
            <span class="text-yellow-400">üìû</span>
            <span>+33 1 45 67 89 10</span>
          </div>
          <div class="flex items-center gap-3">
            <span class="text-yellow-400">üìç</span>
            <span>456 Rue des Tropiques, Paris</span>
          </div>
          <div class="flex items-center gap-3">
            <span class="text-yellow-400">üïí</span>
            <span>Mar-Dim: 18h-2h</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Overlay sombre pour le reste de l'√©cran quand le menu est ouvert -->
  <div id="menu-backdrop" class="fixed inset-0 bg-black/50 opacity-0 pointer-events-none transition-all duration-500 z-30"></div>
</header>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const burgerBtn = document.getElementById('burger-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    const menuBackdrop = document.getElementById('menu-backdrop');
    const closeMenu = document.getElementById('close-menu');
    const header = document.getElementById('header');
    const navItems = document.querySelectorAll('.nav-item');
    const burgerLines = document.querySelectorAll('.burger-line');

    let isMenuOpen = false;

    // Fonction pour ouvrir le menu
    function openMenu() {
      isMenuOpen = true;

      // Afficher le menu lat√©ral - glisse depuis la droite
      mobileMenu.classList.remove('translate-x-full');
      mobileMenu.classList.add('translate-x-0');

      // Afficher l'overlay sombre
      menuBackdrop.classList.remove('opacity-0', 'pointer-events-none');
      menuBackdrop.classList.add('opacity-100', 'pointer-events-auto');

      // Animer les lignes du burger vers X
      burgerLines[0].style.transform = 'rotate(45deg) translate(6px, 6px)';
      burgerLines[1].style.opacity = '0';
      burgerLines[1].style.transform = 'translateX(20px)';
      burgerLines[2].style.transform = 'rotate(-45deg) translate(6px, -6px)';

      // Animation √©chelonn√©e des √©l√©ments de navigation
      navItems.forEach((item, index) => {
        item.style.opacity = '0';
        item.style.transform = 'translateX(30px)';
        setTimeout(() => {
          item.style.opacity = '1';
          item.style.transform = 'translateX(0)';
        }, index * 100 + 200);
      });

      // Bloquer le scroll
      document.body.style.overflow = 'hidden';
    }

    // Fonction pour fermer le menu
    function closeMenuFunc() {
      isMenuOpen = false;

      // Cacher le menu lat√©ral - glisse vers la droite
      mobileMenu.classList.add('translate-x-full');
      mobileMenu.classList.remove('translate-x-0');

      // Cacher l'overlay sombre
      menuBackdrop.classList.add('opacity-0', 'pointer-events-none');
      menuBackdrop.classList.remove('opacity-100', 'pointer-events-auto');

      // Restaurer les lignes du burger
      burgerLines[0].style.transform = 'none';
      burgerLines[1].style.opacity = '1';
      burgerLines[1].style.transform = 'none';
      burgerLines[2].style.transform = 'none';

      // D√©bloquer le scroll
      document.body.style.overflow = '';
    }

    // Initialiser les transitions des nav items
    navItems.forEach((item) => {
      item.style.transition = 'all 0.4s cubic-bezier(0.23, 1, 0.32, 1)';
    });

    // Event listeners
    burgerBtn?.addEventListener('click', () => {
      if (isMenuOpen) {
        closeMenuFunc();
      } else {
        openMenu();
      }
    });

    closeMenu?.addEventListener('click', closeMenuFunc);

    // Fermer quand on clique sur un lien de navigation
    navItems.forEach(item => {
      item.addEventListener('click', (e) => {
        // Petite pause pour l'effet visuel
        setTimeout(closeMenuFunc, 200);
      });
    });

    // Fermer avec la touche Escape
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && isMenuOpen) {
        closeMenuFunc();
      }
    });

    // Fermer en cliquant sur l'overlay sombre
    menuBackdrop?.addEventListener('click', () => {
      if (isMenuOpen) {
        closeMenuFunc();
      }
    });

    // Effet de scroll sur le header
    let lastScrollY = window.scrollY;
    let ticking = false;

    function updateHeader() {
      const currentScrollY = window.scrollY;

      // Changement de transparence
      if (currentScrollY > 50) {
        header.classList.remove('bg-red-700/95');
        header.classList.add('bg-red-700');
      } else {
        header.classList.add('bg-red-700/95');
        header.classList.remove('bg-red-700');
      }

      // Auto-hide/show header (sauf si menu ouvert)
      if (!isMenuOpen) {
        if (currentScrollY > lastScrollY && currentScrollY > 200) {
          header.style.transform = 'translateY(-100%)';
        } else {
          header.style.transform = 'translateY(0)';
        }
      }

      lastScrollY = currentScrollY;
      ticking = false;
    }

    window.addEventListener('scroll', () => {
      if (!ticking) {
        requestAnimationFrame(updateHeader);
        ticking = true;
      }
    });

    // Smooth scroll pour les liens d'ancre
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      });
    });
  });
</script>

<style>
  /* Transition fluide pour le menu lat√©ral */
  .menu-overlay {
    transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }

  /* Animation des lignes du burger */
  .burger-line {
    transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
  }

  /* Effet glow sur le bouton burger */
  .burger-menu:hover {
    filter: drop-shadow(0 0 8px rgba(255, 212, 63, 0.6));
  }

  /* Animation de pulsation pour les √©l√©ments de fond - r√©duite */
  @keyframes pulse {
    0%, 100% {
      opacity: 0.03;
      transform: scale(1);
    }
    50% {
      opacity: 0.06;
      transform: scale(1.02);
    }
  }

  /* Am√©lioration de la lisibilit√© */
  .nav-item {
    text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.9);
  }

  /* Am√©lioration du contraste pour le titre du menu */
  .font-\[\'Dancing_Script\'\] {
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .nav-item {
      font-size: 2rem !important;
    }
  }

  /* Smooth animations */
  * {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Am√©lioration du backdrop blur pour les navigateurs */
  @supports (backdrop-filter: blur(10px)) {
    .backdrop-blur-md {
      backdrop-filter: blur(12px);
    }
    .backdrop-blur-sm {
      backdrop-filter: blur(6px);
    }
  }
</style>
